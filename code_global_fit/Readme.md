## Overview

This program uses the **BFGS method** to fit multicomponent diffusion data, assuming a **single temperature-independent eigenvector matrix [Q]** and **three sets of eigenvalues** corresponding to three different temperatures.

To account for uncertainties in the determination of interface positions, the **interface position (x₀)** is treated as an additional fitting parameter, with **one x₀ for each diffusion couple experiment**.

The diffusion data used for fitting come from diffusion couple experiments reported in **Guo and Zhang (2018, 2020)** and **one experiment conducted in this study**. The data are grouped into three categories based on experimental temperature. For each temperature, three Excel files are provided:

- **Measured diffusion profiles**
- **Boundary conditions (far-field melt compositions)**
- **1σ errors on measured oxide concentrations**

For example, at **1260 °C**:
- **`1260_RealData_8Comp.xlsx`** contains all measured diffusion profiles.
- **`1260_RealBoundary_8Comp.xlsx`** contains the far-field melt compositions for all experiments.
- **`1260_RealError_8Comp.xlsx`** contains the 1σ errors on measured oxide concentrations.

---

## How to Use the Program

This folder contains four MATLAB files:

1. **`BFGS_main.m`** — main program  
2. **`calculate_J.m`** — subroutine  
3. **`calculate_J7.m`** — subroutine  
4. **`con.m`** — subroutine  

The main program, **`BFGS_main.m`**, reads the initial guesses for the **natural logarithm of eigenvalues** and the **eigenvector matrix** from the Excel file **`Initial_beta.xlsx`**.

The initial guess is arranged as a **10 × 7 matrix**, where:
- The **first three rows** correspond to the natural logarithm of eigenvalues at **1260 °C, 1350 °C, and 1500 °C**.
- The **last seven rows** correspond to the eigenvector matrix.

The eigenvalues have units of **μm²/s**, and the elements of the eigenvector matrix are dimensionless scalars.  
The file **`Initial_beta.xlsx`** can be modified by the user, provided that the eigenvector matrix remains **invertible**.

---

## Output Variables

After the main program finishes running:

- The optimized eigenvalues and eigenvector matrix are stored in **`trans_beta`**.
- The corresponding **1σ uncertainties** are stored in **`error_trans_beta`**.
- The fitted interface positions are stored in **`X0`**, with **1σ errors** stored in **`error_X0`**.

Note that the program **does not automatically generate output files**.

The files:
- **`optimized_beta(excluding BS7&8C).xlsx`**
- **`optimized_beta(including BS7&8C).xlsx`**

were generated by the authors and contain the optimized natural log of eigenvalues, eigenvector matrix, and interface positions. These files are provided **for comparison only**, and users may compare their fitting results with those reported in these Excel files.

---

## Notes

For additional implementation details, assumptions, and numerical settings, please refer to the **comments and notes within each MATLAB code file**.
